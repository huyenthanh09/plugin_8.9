// (C) 2021 GoodData Corporation
import React from "react";
import { injectIntl } from "react-intl";
import { Button } from "@gooddata/sdk-ui-kit";
import { selectCanManageACL, selectSettings, useDashboardSelector, selectBackendCapabilities, selectCanManageWorkspace, selectDashboardLockStatus, selectIsReadOnly, selectDashboardRef, selectListedDashboardsMap, } from "../../../model";
import { HiddenShareButton } from "./HiddenShareButton";
var DefaultShareButtonCore = function (_a) {
    var intl = _a.intl, onShareButtonClick = _a.onShareButtonClick;
    var settings = useDashboardSelector(selectSettings);
    var capabilities = useDashboardSelector(selectBackendCapabilities);
    var hasPermission = useDashboardSelector(selectCanManageACL);
    var isLocked = useDashboardSelector(selectDashboardLockStatus);
    var isAdmin = useDashboardSelector(selectCanManageWorkspace);
    var isReadOnly = useDashboardSelector(selectIsReadOnly);
    var currentDashboardRef = useDashboardSelector(selectDashboardRef);
    var dashboardsList = useDashboardSelector(selectListedDashboardsMap);
    var currentDashboardIsNormallyVisible = currentDashboardRef && dashboardsList.has(currentDashboardRef);
    if (settings.enableAnalyticalDashboardPermissions &&
        capabilities.supportsAccessControl &&
        hasPermission &&
        currentDashboardIsNormallyVisible &&
        (!isLocked || isAdmin) &&
        !isReadOnly) {
        return (React.createElement(React.Fragment, null,
            React.createElement(Button, { onClick: function () { return onShareButtonClick(); }, value: intl.formatMessage({ id: "share.button.text" }), className: "gd-button-secondary dash-header-share-button s-header-share-button gd-button gd-icon-users" })));
    }
    else {
        return React.createElement(HiddenShareButton, null);
    }
};
/**
 * @alpha
 */
export var DefaultShareButton = injectIntl(DefaultShareButtonCore);
//# sourceMappingURL=DefaultShareButton.js.map